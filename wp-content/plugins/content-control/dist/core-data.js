!function(){"use strict";var e={n:function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,{a:n}),n},d:function(t,n){for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{LICENSE_STORE:function(){return I},RESTRICTION_STORE:function(){return ot},SETTINGS_STORE:function(){return pe},Status:function(){return v},URL_SEARCH_STORE:function(){return un},appendUrlParams:function(){return f},fetch:function(){return _},fetchCredOpts:function(){return p},fetchWithCreds:function(){return T},getErrorMessage:function(){return A},licenseDefaults:function(){return m},licenseStore:function(){return Se},localControls:function(){return y},restBase:function(){return S},restUrl:function(){return g},restrictionDefaults:function(){return dt},restrictionsStore:function(){return an},settingsDefaults:function(){return Te},settingsStore:function(){return nt},urlSearchStore:function(){return Gn},useLicense:function(){return Kn},useSettings:function(){return xn},validateRestriction:function(){return ct}});var n={};e.r(n),e.d(n,{activateLicense:function(){return V},changeActionStatus:function(){return x},checkLicenseStatus:function(){return F},deactivateLicense:function(){return Y},hydrate:function(){return j},removeLicense:function(){return M},updateLicenseKey:function(){return B}});var r={};e.r(r),e.d(r,{getLicenseData:function(){return ne},getLicenseKey:function(){return re},getLicenseStatus:function(){return se}});var s={};e.r(s),e.d(s,{getConnectInfo:function(){return ae},getDispatchError:function(){return Ee},getDispatchStatus:function(){return ue},getLicenseData:function(){return ie},getLicenseKey:function(){return ce},getLicenseStatus:function(){return oe},hasDispatched:function(){return le},isDispatching:function(){return de}});var i={};e.r(i),e.d(i,{changeActionStatus:function(){return De},hydrate:function(){return He},hydrateBlockTypes:function(){return Ue},saveSettings:function(){return Oe},stageUnsavedChanges:function(){return Le},updateSettings:function(){return me}});var c={};e.r(c),e.d(c,{getKnownBlockTypes:function(){return Me},getSettings:function(){return Be}});var o={};e.r(o),e.d(o,{getDispatchError:function(){return tt},getDispatchStatus:function(){return ze},getExcludedBlocks:function(){return Je},getKnownBlockTypes:function(){return Qe},getReqPermission:function(){return Xe},getSetting:function(){return $e},getSettings:function(){return je},getUnsavedChanges:function(){return qe},hasDispatched:function(){return et},hasUnsavedChanges:function(){return We},isDispatching:function(){return Ze}});var a={};e.r(a),e.d(a,{addNotice:function(){return Rt},changeActionStatus:function(){return ht},changeEditorId:function(){return Nt},clearEditorData:function(){return mt},clearNotice:function(){return vt},clearNotices:function(){return It},createRestriction:function(){return Ot},deleteRestriction:function(){return Ht},hydrate:function(){return Ut},updateEditorValues:function(){return Dt},updateRestriction:function(){return Lt}});var u={};e.r(u),e.d(u,{getRestriction:function(){return qt},getRestrictions:function(){return $t}});var d={};e.r(d),e.d(d,{getDispatchError:function(){return on},getDispatchStatus:function(){return rn},getEditorId:function(){return Zt},getEditorValues:function(){return en},getNextPriority:function(){return tn},getNotices:function(){return Wt},getRestriction:function(){return Xt},getRestrictionDefaults:function(){return nn},getRestrictions:function(){return Jt},hasDispatched:function(){return cn},isDispatching:function(){return sn},isEditorActive:function(){return zt}});var l={};e.r(l),e.d(l,{changeActionStatus:function(){return Nn},searchError:function(){return In},searchRequest:function(){return Rn},searchSuccess:function(){return vn},updateSuggestions:function(){return hn}});var E={};e.r(E),e.d(E,{getDispatchError:function(){return Pn},getDispatchStatus:function(){return Un},getSuggestions:function(){return Hn},hasDispatched:function(){return bn},isDispatching:function(){return wn}});const S="content-control/v2",g=`${wpApiSettings.root}${S}/`,p=(e={})=>({...e,headers:{...e.headers,"Content-Type":"application/json","X-WP-Nonce":wpApiSettings.nonce},credentials:"same-origin"}),_=(e,t={})=>(t.body&&(t.body=JSON.stringify(t.body)),wpApiSettings.root.includes("?")&&(e=e.replace("?","&")),{type:"FETCH",path:`${wpApiSettings.root}${e}`,options:p(t)}),T=(e,t)=>new Promise(((n,r)=>{window.fetch(e,p(t)).then((e=>e.json())).then((e=>n(e))).catch((e=>r(e)))}));var y={FETCH({path:e,options:t}){return new Promise(((n,r)=>{window.fetch(e,t).then((e=>e.json())).then((e=>n(e))).catch((e=>r(e)))}))}};const f=(e,t)=>{const n=Object.fromEntries(Object.entries(t).filter((([,e])=>!!e)));return`${e}?${new URLSearchParams({...n})}`},A=e=>e instanceof Error?e.message:String(e);var C=window.wp.data,h=window.wp.dataControls,R=window.wp.i18n;let v=function(e){return e.Idle="IDLE",e.Resolving="RESOLVING",e.Error="ERROR",e.Success="SUCCESS",e}({});const I="content-control/license",N={ACTIVATE_LICENSE:"ACTIVATE_LICENSE",CONNECT_SITE:"CONNECT_SITE",DEACTIVATE_LICENSE:"DEACTIVATE_LICENSE",REMOVE_LICENSE:"REMOVE_LICENSE",UPDATE_LICENSE_KEY:"UPDATE_LICENSE_KEY",CHECK_LICENSE_STATUS:"CHECK_LICENSE_STATUS",CHANGE_ACTION_STATUS:"CHANGE_ACTION_STATUS",HYDRATE_LICENSE_DATA:"HYDRATE_LICENSE_DATA",LICENSE_FETCH_ERROR:"LICENSE_FETCH_ERROR"},D={success:!1,license:"invalid",license_limit:1,site_count:0,expires:"",activations_left:0,price_id:0,error:void 0,error_message:void 0},m={key:"",status:D},O={license:m},L=(e="")=>(e&&(e=`/${e}`),`content-control/v2/license${e}`),{ACTIVATE_LICENSE:H,CONNECT_SITE:U,DEACTIVATE_LICENSE:w,UPDATE_LICENSE_KEY:b,REMOVE_LICENSE:P,CHECK_LICENSE_STATUS:G,HYDRATE_LICENSE_DATA:k,CHANGE_ACTION_STATUS:K}=N,x=(e,t,n)=>(n&&console.log(e,n),{type:K,actionName:e,status:t,message:n});function*V(e){const t="activateLicense";try{yield x(t,v.Resolving);const n=yield _(L("activate"),{method:"POST",body:{licenseKey:e}});if(n){const{status:e,connectInfo:r}=n;return yield x(t,v.Success),void 0!==r?{type:U,licenseStatus:e,connectInfo:r}:{type:H,licenseStatus:e}}return x(t,v.Error,(0,R.__)("An error occurred, license were not saved.","content-control"))}catch(e){return x(t,v.Error,A(e))}}function*Y(){const e="deactivateLicense";try{yield x(e,v.Resolving);const t=yield _(L("deactivate"),{method:"POST"});return t?(yield x(e,v.Success),{type:w,licenseStatus:t.status}):x(e,v.Error,(0,R.__)("An error occurred, license were not saved.","content-control"))}catch(t){return x(e,v.Error,A(t))}}function*F(){const e="checkLicenseStatus";try{yield x(e,v.Resolving);const t=yield _(L("status"),{method:"POST"});return t?(yield x(e,v.Success),{type:G,licenseStatus:t.status}):x(e,v.Error,(0,R.__)("An error occurred, license were not saved.","content-control"))}catch(t){return x(e,v.Error,A(t))}}function*B(e){const t="updateLicenseKey";if((yield(0,C.resolveSelect)(I,"getLicenseKey"))===e)return x(t,v.Error,(0,R.__)("The license key is the same as the current one.","content-control"));try{yield x(t,v.Resolving);const n=yield _(L(),{method:"POST",body:{licenseKey:e}});return n?(yield x(t,v.Success),{type:b,licenseKey:e,licenseStatus:n.status}):x(t,v.Error,(0,R.__)("An error occurred, license were not saved.","content-control"))}catch(e){return x(t,v.Error,A(e))}}function*M(){const e="removeLicense";try{return yield x(e,v.Resolving),(yield _(L(),{method:"DELETE"}))?(yield x(e,v.Success),{type:P}):x(e,v.Error,(0,R.__)("An error occurred, license were not saved.","content-control"))}catch(t){return x(e,v.Error,A(t))}}const j=e=>({type:k,license:e}),{ACTIVATE_LICENSE:Q,CONNECT_SITE:$,DEACTIVATE_LICENSE:q,REMOVE_LICENSE:W,UPDATE_LICENSE_KEY:J,CHECK_LICENSE_STATUS:X,HYDRATE_LICENSE_DATA:z,CHANGE_ACTION_STATUS:Z,LICENSE_FETCH_ERROR:ee}=N;const{LICENSE_FETCH_ERROR:te}=N;function*ne(){try{const e=yield _(L(),{method:"GET"});return e?j(e):{type:te,message:(0,R.__)("An error occurred, license data was not loaded.","content-control")}}catch(e){return{type:te,message:A(e)}}}function*re(){const{key:e}=yield(0,h.select)(I,"getLicenseData");return e}function*se(){const{status:e}=yield(0,h.select)(I,"getLicenseData");return e}const ie=e=>e.license,ce=e=>{const{key:t}=ie(e);return t},oe=e=>{const{status:t}=ie(e);return{...D,...t}},ae=e=>e.connectInfo,ue=(e,t)=>e?.dispatchStatus?.[t]?.status,de=(e,t)=>{if(!Array.isArray(t))return ue(e,t)===v.Resolving;let n=!1;for(let r=0;t.length>r;r++)if(n=ue(e,t[r])===v.Resolving,n)return!0;return n},le=(e,t)=>{const n=ue(e,t);return!!(n&&[v.Success,v.Error].indexOf(n)>=0)},Ee=(e,t)=>e?.dispatchStatus?.[t]?.error,Se=(0,C.createReduxStore)(I,{initialState:O,selectors:s,actions:n,reducer:(e,{type:t,license:n,licenseKey:r,licenseStatus:s,connectInfo:i,actionName:c,status:o,message:a})=>{switch(t){case Q:case q:case X:return{...e,license:{...e.license,status:s}};case $:return{...e,license:{...e.license,status:s},connectInfo:i};case J:return{...e,license:{...e.license,key:r,status:s}};case W:return{...e,license:{key:"",status:{}}};case z:return{...e,license:n};case ee:return{...e,error:a};case Z:return{...e,dispatchStatus:{...e.dispatchStatus,[c]:{...e?.dispatchStatus?.[c],status:o,error:a}}};default:return e}},resolvers:r,controls:{...h.controls,...y}});var ge=window.wp.hooks;const pe="content-control/settings",_e={UPDATE:"UPDATE",STAGE_CHANGES:"STAGE_CHANGES",SAVE_CHANGES:"SAVE_CHANGES",HYDRATE:"HYDRATE",CHANGE_ACTION_STATUS:"CHANGE_ACTION_STATUS",SETTINGS_FETCH_ERROR:"SETTINGS_FETCH_ERROR",HYDRATE_BLOCK_TYPES:"HYDRATE_BLOCK_TYPES",BLOCK_TYPES_FETCH_ERROR:"BLOCK_TYPES_FETCH_ERROR"},Te=(0,ge.applyFilters)("contentControl.defaultSettings",{defaultDenialMessage:"",excludeAdmins:!0,excludedBlocks:[],permissions:{view_block_controls:"edit_posts",edit_block_controls:"edit_posts",edit_restrictions:"manage_options",manage_settings:"manage_options"},mediaQueries:{mobile:{override:!1,breakpoint:640},tablet:{override:!1,breakpoint:920},desktop:{override:!1,breakpoint:1440}}}),{currentSettings:ye=Te}=contentControlCoreData,fe={settings:ye,unsavedChanges:{}},Ae=()=>"content-control/v2/settings",{UPDATE:Ce,SAVE_CHANGES:he,STAGE_CHANGES:Re,HYDRATE:ve,CHANGE_ACTION_STATUS:Ie,HYDRATE_BLOCK_TYPES:Ne}=_e,De=(e,t,n)=>(n&&console.log(e,n),{type:Ie,actionName:e,status:t,message:n});function*me(e){const t="updateSettings";try{yield De(t,v.Resolving);const n=yield(0,h.select)(pe,"getSettings"),r=yield _(Ae(),{method:"PUT",body:{settings:{...n,...e}}});return r?(yield De(t,v.Success),{type:Ce,settings:r}):De(t,v.Error,(0,R.__)("An error occurred, settings were not saved.","content-control"))}catch(e){return De(t,v.Error,A(e))}}function*Oe(){const e="saveSettings";try{yield De(e,v.Resolving);const t=yield(0,h.select)(pe,"getSettings"),n=yield(0,h.select)(pe,"getUnsavedChanges"),r=yield _(Ae(),{method:"PUT",body:{settings:{...t,...n}}});return r?(yield De(e,v.Success),{type:he,settings:r}):De(e,v.Error,(0,R.__)("An error occurred, settings were not saved.","content-control"))}catch(t){return De(e,v.Error,A(t))}}const Le=e=>({type:Re,settings:e}),He=e=>({type:ve,settings:e}),Ue=e=>({type:Ne,blockTypes:e}),{UPDATE:we,STAGE_CHANGES:be,SAVE_CHANGES:Pe,HYDRATE:Ge,HYDRATE_BLOCK_TYPES:ke,CHANGE_ACTION_STATUS:Ke,SETTINGS_FETCH_ERROR:xe,BLOCK_TYPES_FETCH_ERROR:Ve}=_e;const{SETTINGS_FETCH_ERROR:Ye,BLOCK_TYPES_FETCH_ERROR:Fe}=_e;function*Be(){try{const{settings:e}=yield _(Ae(),{method:"GET"});return e?He(e):{type:Ye,message:(0,R.__)("An error occurred, settings were not loaded.","content-control")}}catch(e){return{type:Ye,message:A(e)}}}function*Me(){try{const e=yield _(`${S}/blockTypes`,{method:"GET"});return e?Ue(e):{type:Fe,message:(0,R.__)("An error occurred, block types were not loaded.","content-control")}}catch(e){return{type:Fe,message:A(e)}}}const je=e=>e.settings,Qe=e=>e.knownBlockTypes,$e=(e,t,n)=>{var r;return null!==(r=je(e)[t])&&void 0!==r?r:n},qe=e=>{var t;return null!==(t=e?.unsavedChanges)&&void 0!==t?t:{}},We=e=>{var t;return Object.keys(null!==(t=e?.unsavedChanges)&&void 0!==t?t:{}).length>0},Je=e=>$e(e,"excludedBlocks",Te.excludedBlocks),Xe=(e,t)=>{const n=$e(e,"permissions",Te.permissions)[t];return"string"==typeof n?n:"manage_options"},ze=(e,t)=>e?.dispatchStatus?.[t]?.status,Ze=(e,t)=>{if(!Array.isArray(t))return ze(e,t)===v.Resolving;let n=!1;for(let r=0;t.length>r;r++)if(n=ze(e,t[r])===v.Resolving,n)return!0;return n},et=(e,t)=>{const n=ze(e,t);return!!(n&&[v.Success,v.Error].indexOf(n)>=0)},tt=(e,t)=>e?.dispatchStatus?.[t]?.error,nt=(0,C.createReduxStore)(pe,{initialState:fe,selectors:o,actions:i,reducer:(e,{type:t,settings:n,actionName:r,status:s,message:i,blockTypes:c})=>{var o;switch(t){case Ge:return{...e,settings:n};case ke:return{...e,knownBlockTypes:c};case Ve:case xe:return{...e,error:i};case be:return{...e,unsavedChanges:{...null!==(o=e.unsavedChanges)&&void 0!==o?o:{},...n}};case Pe:return{...e,settings:{...e.settings,...n},unsavedChanges:{}};case we:return{...e,settings:{...e.settings,...n}};case Ke:return{...e,dispatchStatus:{...e.dispatchStatus,[r]:{...e?.dispatchStatus?.[r],status:s,error:i}}};default:return e}},resolvers:c,controls:{...h.controls,...y}}),rt=(e=void 0)=>{const t="content-control/v2/restrictions";return e?`${t}/${e}`:t},st=({title:e,excerpt:t,...n})=>({...n,title:"string"==typeof e?e:e.raw,description:"string"==typeof t?t:t.raw}),it=({description:e,...t})=>({...t,excerpt:e}),ct=e=>!!e&&(e.title.length?!(!e.settings?.conditions?.items?.length&&"publish"===e.status)||{message:(0,R.__)("Please provide at least one condition for this restriction before enabling it.","content-control"),tabName:"content"}:{message:(0,R.__)("Please provide a name for this restriction.","content-control"),tabName:"general",field:"title"}),ot="content-control/restrictions",at={CREATE:"CREATE",UPDATE:"UPDATE",DELETE:"DELETE",HYDRATE:"HYDRATE",ADD_NOTICE:"ADD_NOTICE",CLEAR_NOTICE:"CLEAR_NOTICE",CLEAR_NOTICES:"CLEAR_NOTICES",EDITOR_CHANGE_ID:"EDITOR_CHANGE_ID",EDITOR_CLEAR_DATA:"EDITOR_CLEAR_DATA",EDITOR_UPDATE_VALUES:"EDITOR_UPDATE_VALUES",CHANGE_ACTION_STATUS:"CHANGE_ACTION_STATUS",RESTRICTIONS_FETCH_ERROR:"RESTRICTIONS_FETCH_ERROR"},ut={restrictions:[],editor:{},notices:[]},dt={id:0,title:"",description:"",status:"draft",priority:0,settings:{userStatus:"logged_in",roleMatch:"any",userRoles:[],protectionMethod:"redirect",redirectType:"login",redirectUrl:"",replacementType:"message",replacementPage:void 0,archiveHandling:"filter_post_content",archiveReplacementPage:void 0,archiveRedirectType:"login",archiveRedirectUrl:"",additionalQueryHandling:"filter_post_content",showExcerpts:!1,overrideMessage:!1,customMessage:"",conditions:{logicalOperator:"or",items:[]}}},{CREATE:lt,DELETE:Et,UPDATE:St,HYDRATE:gt,ADD_NOTICE:pt,CLEAR_NOTICE:_t,CLEAR_NOTICES:Tt,CHANGE_ACTION_STATUS:yt,EDITOR_CHANGE_ID:ft,EDITOR_CLEAR_DATA:At,EDITOR_UPDATE_VALUES:Ct}=at,ht=(e,t,n)=>(n&&console.log(e,n),{type:yt,actionName:e,status:t,message:n}),Rt=e=>({type:pt,notice:e}),vt=e=>({type:_t,noticeId:e}),It=()=>({type:Tt});function*Nt(e){try{if(void 0===e)return{type:ft,editorId:void 0,editorValues:void 0};const t=yield(0,h.select)(ot,"getRestrictionDefaults");let n="new"===e?t:void 0;return"number"==typeof e&&e>0&&(n=yield(0,h.select)(ot,"getRestriction",e)),{type:ft,editorId:e,editorValues:n}}catch(e){return console.log(e),ht("changeEditorId",v.Error,A(e))}}const Dt=e=>({type:Ct,editorValues:e}),mt=()=>({type:At});function*Ot(e){const t="createRestriction";try{yield ht(t,v.Resolving);const{id:n,...r}=e,s=ct(e);if(!0!==s)return yield ht(t,v.Error,s||(0,R.__)("An error occurred, restriction was not saved.")),Rt({id:"restriction-error",type:"error",message:"object"==typeof s?s.message:"",closeDelay:5e3});const i=yield _(rt(),{method:"POST",body:it(r)});if(i){yield ht(t,v.Success);const n=yield(0,h.select)(ot,"getEditorId"),r={type:lt,restriction:st(i)};return"new"===n?(yield r,void(yield Nt(i.id))):(yield Rt({id:"restriction-saved",type:"success",message:(0,R.sprintf)(
// translators: %s: restriction title.
(0,R.__)('Restriction "%s" saved successfully.',"content-control"),e?.title),closeDelay:5e3}),r)}return ht(t,v.Error,(0,R.__)("An error occurred, restriction was not saved.","content-control"))}catch(e){return ht(t,v.Error,A(e))}}function*Lt(e){const t="updateRestriction";try{yield ht(t,v.Resolving);const n=ct(e);if(!0!==n)return yield ht(t,v.Error,n||(0,R.__)("An error occurred, restriction was not saved.")),Rt({id:"restriction-error",type:"error",message:"object"==typeof n?n.message:"",closeDelay:5e3});const r=yield(0,h.select)(ot,"getRestriction",e.id),s=yield _(rt(r.id),{method:"POST",body:it(e)});return s?(yield ht(t,v.Success),yield Rt({id:"restriction-saved",type:"success",message:(0,R.sprintf)(
// translators: %s: restriction title.
(0,R.__)('Restriction "%s" saved successfully.',"content-control"),e?.title),closeDelay:5e3}),{type:St,restriction:st(s)}):ht(t,v.Error,(0,R.__)("An error occurred, restriction was not saved.","content-control"))}catch(e){return ht(t,v.Error,A(e))}}function*Ht(e,t=!1){const n="deleteRestriction";try{yield ht(n,v.Resolving);const r=yield(0,h.select)(ot,"getRestriction",e),s=t?"?force=true":"",i=rt(r.id)+s;return(yield _(i,{method:"DELETE"}))?(yield ht(n,v.Success),t?{type:Et,restrictionId:e}:{type:St,restriction:{...r,status:"trash"}}):ht(n,v.Error,(0,R.__)("An error occurred, restriction was not deleted.","content-control"))}catch(e){return ht(n,v.Error,A(e))}}const Ut=e=>({type:gt,restrictions:e}),{CREATE:wt,DELETE:bt,UPDATE:Pt,HYDRATE:Gt,ADD_NOTICE:kt,CLEAR_NOTICE:Kt,CLEAR_NOTICES:xt,CHANGE_ACTION_STATUS:Vt,EDITOR_CHANGE_ID:Yt,EDITOR_CLEAR_DATA:Ft,EDITOR_UPDATE_VALUES:Bt,RESTRICTIONS_FETCH_ERROR:Mt}=at;const{UPDATE:jt,RESTRICTIONS_FETCH_ERROR:Qt}=at;function*$t(){try{const e=yield _(f(rt(),{status:["any","trash","auto-draft"],per_page:100,context:"edit"}));if(e){const t=e.map(st);return Ut(t)}return{type:Qt,message:(0,R.__)("An error occurred, restrictions were not loaded.","content-control")}}catch(e){return{type:Qt,message:A(e)}}}function*qt(e){try{const t=yield _(f(rt(e),{context:"edit"}));return t?{type:jt,restriction:st(t)}:{type:Qt,message:(0,R.sprintf)(/* translators: 1: restriction id */
(0,R.__)("An error occurred, restriction %d were not loaded.","content-control"),e)}}catch(e){return{type:Qt,message:A(e)}}}const Wt=e=>e.notices||[],Jt=e=>e.restrictions||[],Xt=(e,t)=>Jt(e).find((e=>e.id===t)),zt=e=>{const t=e?.editor?.id;return"string"==typeof t&&"new"===t||"number"==typeof t&&t>0},Zt=e=>e?.editor?.id,en=e=>e?.editor?.values,tn=e=>{const t=Jt(e);return 0===t.length?0:t.reduce(((e,t)=>t.priority>e?t.priority:e),0)+1},nn=e=>{const t=tn(e);return{...(0,ge.applyFilters)("contentControl.defaultRestrictionValues",dt),priority:t}},rn=(e,t)=>e?.dispatchStatus?.[t]?.status,sn=(e,t)=>{if(!Array.isArray(t))return rn(e,t)===v.Resolving;let n=!1;for(let r=0;t.length>r;r++)if(n=rn(e,t[r])===v.Resolving,n)return!0;return n},cn=(e,t)=>{const n=rn(e,t);return!!(n&&[v.Success,v.Error].indexOf(n)>=0)},on=(e,t)=>e?.dispatchStatus?.[t]?.error,an=(0,C.createReduxStore)(ot,{initialState:ut,selectors:d,actions:a,reducer:(e=ut,{restrictions:t,restriction:n,restrictionId:r,type:s,editorId:i,editorValues:c,actionName:o,status:a,message:u,notice:d,noticeId:l})=>{switch(s){case wt:return{...e,restrictions:[...e.restrictions,n]};case Pt:return{...e,restrictions:e.restrictions.filter((e=>e.id!==n.id)).concat([n])};case bt:return{...e,restrictions:e.restrictions.filter((e=>e.id!==r))};case Gt:return{...e,restrictions:t};case kt:return{...e,notices:[...e.notices.filter((({id:e})=>e!==d.id)),d]};case Kt:return{...e,notices:e.notices.filter((({id:e})=>e!==l))};case xt:return{...e,notices:[]};case Mt:return{...e,error:u};case Yt:return{...e,editor:{...e.editor,id:i,values:c}};case Bt:return{...e,editor:{...e.editor,values:{...e.editor?.values,...c}}};case Ft:return{...e,editor:{}};case Vt:return{...e,dispatchStatus:{...e.dispatchStatus,[o]:{...e?.dispatchStatus?.[o],status:a,error:u}}};default:return e}},resolvers:u,controls:{...h.controls,...y}}),un="content-control/url-search",dn={SEARCH_REQUEST:"SEARCH_REQUEST",SEARCH_SUCCESS:"SEARCH_SUCCESS",SEARCH_ERROR:"SEARCH_ERROR",UPDATE_SUGGESTIONS:"UPDATE_SUGGESTIONS",CHANGE_ACTION_STATUS:"CHANGE_ACTION_STATUS"},ln={currentQuery:"",searchResults:[],queries:{}};var En=window.wp.apiFetch,Sn=e.n(En);const gn=(e={search:""})=>f("wp/v2/search",e),pn=(e,t={})=>({type:"FETCH_LINK_SUGGESTIONS",search:e,searchOptions:t});var Tn={async FETCH_LINK_SUGGESTIONS({search:e,searchOptions:t={},settings:n={disablePostFormats:!1}}){const{isInitialSuggestions:r=!1,type:s,subtype:i,page:c,perPage:o=(r?3:20)}=t,{disablePostFormats:a=!1}=n,u=[],d=e=>!s||s===e||Array.isArray(s)&&s.indexOf(e)>=0;return d("post")&&u.push(Sn()({path:gn({search:e,page:c,per_page:o,type:"post",subtype:i}),cache:"no-cache"}).then((e=>e.map((e=>({...e,meta:{kind:"post-type",subtype:i}}))))).catch((()=>[]))),d("term")&&u.push(Sn()({path:gn({search:e,page:c,per_page:o,type:"term",subtype:i}),cache:"no-cache"}).then((e=>e.map((e=>({...e,meta:{kind:"taxonomy",subtype:i}}))))).catch((()=>[]))),!a&&d("post-format")&&u.push(Sn()({path:gn({search:e,page:c,per_page:o,type:"post-format",subtype:i}),cache:"no-cache"}).then((e=>e.map((e=>({...e,meta:{kind:"taxonomy",subtype:i}}))))).catch((()=>[]))),d("attachment")&&u.push(Sn()({path:gn({search:e,page:c,per_page:o}),cache:"no-cache"}).then((e=>e.map((e=>({...e,meta:{kind:"media"}}))))).catch((()=>[]))),Promise.all(u).then((e=>e.reduce(((e,t)=>e.concat(t)),[]).filter((e=>!!e.id)).slice(0,o).map((e=>{var t;const n="attachment"===e.type;return{id:e.id,url:n?e.source_url:e.url,title:n?null!==(t=e.title.rendered)&&void 0!==t?t:suggestion.title.raw:e.title||(0,R.__)("(no title)"),type:e?.subtype||e.type,kind:e?.meta?.kind}}))))}};const{SEARCH_REQUEST:yn,SEARCH_SUCCESS:fn,SEARCH_ERROR:An,CHANGE_ACTION_STATUS:Cn}=dn;function*hn(e,t){const n="updateSuggestions";try{yield Nn(n,v.Resolving),yield Rn(e);const r=yield pn(e,t);if(r)return yield Nn(n,v.Success),vn(e,r);const s=(0,R.__)("No results returned","content-control");return yield Nn(n,v.Error,s),In(e,s)}catch(t){const r=A(t);return yield Nn(n,v.Error,r),In(e,r)}}function Rn(e){return{type:yn,queryText:e}}function vn(e,t){return{type:fn,queryText:e,results:t}}function In(e,t){return{type:An,queryText:e,error:t}}const Nn=(e,t,n)=>(n&&console.log(e,n),{type:Cn,actionName:e,status:t,message:n}),{SEARCH_ERROR:Dn,SEARCH_REQUEST:mn,SEARCH_SUCCESS:On,CHANGE_ACTION_STATUS:Ln}=dn;const Hn=e=>e.searchResults||[],Un=(e,t)=>e?.dispatchStatus?.[t]?.status,wn=(e,t)=>{if(!Array.isArray(t))return Un(e,t)===v.Resolving;let n=!1;for(let r=0;t.length>r;r++)if(n=Un(e,t[r])===v.Resolving,n)return!0;return n},bn=(e,t)=>{const n=Un(e,t);return!!(n&&[v.Success,v.Error].indexOf(n)>=0)},Pn=(e,t)=>e?.dispatchStatus?.[t]?.error,Gn=(0,C.createReduxStore)(un,{initialState:ln,selectors:E,actions:l,reducer:(e=ln,{type:t,queryText:n,results:r,error:s,actionName:i,status:c,message:o})=>{var a;switch(t){case mn:return{...e,currentQuery:n};case On:return e.currentQuery===n?{searchResults:r}:e;case Dn:return e.currentQuery===n?{...e,error:s}:e;case Ln:return{...e,dispatchStatus:{...e.dispatchStatus,[i]:{...null!==(a=e?.dispatchStatus?.[i])&&void 0!==a?a:{},status:c,error:o}}};default:return e}},controls:{...h.controls,...y,...Tn}});var kn=window.wp.element,Kn=()=>{var e,t,n,r;const{connectInfo:s,licenseKey:i,licenseStatus:c,isSaving:o}=(0,C.useSelect)((e=>{const t=e(Se);return{connectInfo:t.getConnectInfo(),licenseKey:t.getLicenseKey(),licenseStatus:t.getLicenseStatus(),isSaving:t.isDispatching("activateLicense")||t.isDispatching("deactivateLicense")||t.isDispatching("checkLicenseStatus")||t.isDispatching("updateLicenseKey")||t.isDispatching("removeLicense")}}),[]),{activateLicense:a,deactivateLicense:u,checkLicenseStatus:d,updateLicenseKey:l,removeLicense:E}=(0,C.useDispatch)(Se),S="valid"===c?.license,g=["deactivated","site_inactive","inactive"].includes(null!==(e=c?.license)&&void 0!==e?e:""),p=["invalid","failed"].includes(c?.license),_=p&&["","missing"].includes(null!==(t=c?.error)&&void 0!==t?t:""),T="expired"===c?.license||["invalid","failed"].includes(null!==(n=c?.license)&&void 0!==n?n:"")&&"expired"===c?.error,y="disabled"===c?.license||p&&"disabled"===c?.error,f="no_activations_left"===c?.error,A=!!c?.error,h=p&&A&&!["missing","expired","disabled"].includes(null!==(r=c?.error)&&void 0!==r?r:""),R=(0,kn.useMemo)((()=>S||g||T||y||f),[S,g,T,y,f]),v=(0,kn.useMemo)((()=>S?"active":T?"expired":_?"missing":g?"deactivated":y?"disabled":h?"error":"unknown"),[S,T,_,g,y,h]),I=(0,kn.useMemo)((()=>{var e;let t=null!==(e=c?.price_id)&&void 0!==e?e:null;if(null===t)return-1;switch("string"==typeof t&&(t=parseInt(t,10)),t){default:return-1;case!1:case 0:return 0;case 1:case 2:case 3:case 4:return t}}),[c?.price_id]);return{connectInfo:s,licenseKey:i,licenseStatus:c,licenseLevel:I,activateLicense:a,deactivateLicense:u,checkLicenseStatus:d,updateLicenseKey:l,removeLicense:E,getLicenseStatusName:v,isSaving:o,isLicenseKeyValid:R,isLicenseActive:S,isLicenseDeactivated:g,isLicenseMissing:_,isLicenseExpired:T,isLicenseInvalid:p,isLicenseDisabled:y,isLicenseOverQuota:f,isGeneralError:h,hasError:A}},xn=()=>{const{currentSettings:e,unsavedChanges:t,hasUnsavedChanges:n,isSaving:r}=(0,C.useSelect)((e=>{const t=e(nt);return{unsavedChanges:t.getUnsavedChanges(),hasUnsavedChanges:t.hasUnsavedChanges(),currentSettings:t.getSettings(),isSaving:t.isDispatching("updateSettings")||t.isDispatching("saveSettings")}}),[]),{updateSettings:s,saveSettings:i,stageUnsavedChanges:c}=(0,C.useDispatch)(nt),o=(0,kn.useMemo)((()=>({...e,...t})),[e,t]);return{currentSettings:e,settings:o,getSetting:(e,t)=>{var n;return null!==(n=o[e])&&void 0!==n?n:t},updateSettings:s,saveSettings:i,isSaving:r,hasUnsavedChanges:n,stageUnsavedChanges:c,unsavedChanges:t}};(window.contentControl=window.contentControl||{}).coreData=t}();